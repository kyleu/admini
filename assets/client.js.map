{
  "version": 3,
  "sources": ["../client/src/menu.ts", "../client/src/flash.ts", "../client/src/editor.ts", "../client/src/sortable.ts", "../client/src/link.ts", "../client/src/client.ts"],
  "sourcesContent": ["export function menuInit() {\n  for (const n of Array.from(document.querySelectorAll(\".menu-container .final\"))) {\n    n.scrollIntoView({block: \"nearest\"});\n  }\n}\n", "export function flashInit() {\n  const container = document.getElementById(\"flash-container\")\n  if (container === null) {\n    return;\n  }\n  const x = container.querySelectorAll(\".flash\");\n  if (x.length > 0) {\n    setTimeout(() => {\n      for (const f of x) {\n        const el = f as HTMLElement;\n        el.style.opacity = \"0\";\n        setTimeout(() => el.remove(), 500);\n      }\n    }, 3000)\n  }\n}\n", "const selected = \"--selected\";\n\nexport function editorInit() {\n  let editorCache: { [key: string]: string; } = {};\n  let selectedCache: { [key: string]: HTMLInputElement; } = {};\n  for (const n of Array.from(document.querySelectorAll(\".editor\"))) {\n    const frm = n as HTMLFormElement;\n    const buildCache = () => {\n      editorCache = {};\n      selectedCache = {};\n      for (const el of frm.elements) {\n        const input = el as HTMLInputElement;\n        if (input.name.length > 0) {\n          if (input.name.endsWith(selected)) {\n            selectedCache[input.name] = input;\n          } else {\n            if ((input.type !== \"radio\") || input.checked) {\n              editorCache[input.name] = input.value;\n            }\n            const evt = () => {\n              const cv = selectedCache[input.name + selected];\n              if (cv) {\n                cv.checked = editorCache[input.name] !== input.value;\n              }\n            };\n            input.onchange = evt;\n            input.onkeyup = evt;\n          }\n        }\n      }\n    }\n    frm.onreset = buildCache;\n    buildCache();\n  }\n}\n", "export function sortableInit() {\n  if ((window as any).Sortable) {\n    for (const dd of Array.from(document.getElementsByClassName(\"sortable\"))) {\n      sortableCreate(dd);\n    }\n  }\n}\n\nexport function sortableEdit(el: Element) {\n  while (el.parentElement && !el.classList.contains(\"drag-container\")) {\n    el = el.parentElement;\n  }\n  el.classList.remove(\"readonly\");\n  sortableCreate(el);\n}\n\nfunction sortableCreate(dd: Element) {\n  const Sortable = (window as any).Sortable;\n  if (Sortable) {\n    let l = dd.querySelector(\".l\");\n    if (!l) {\n      l = dd;\n    }\n    const onAdd = (ev: Event) => {\n      const i = (ev as any).item as HTMLElement;\n      new Sortable(i.querySelector(\".container\"), lOpts);\n      (i.querySelector(\".remove\") as HTMLElement).onclick = function() { remove(dd, i); };\n      update(dd);\n    };\n    const lOpts = {group: {name: 'nested'}, handle: '.handle', onAdd: onAdd, onUpdate: () => update(dd), animation: 150, fallbackOnBody: true, swapThreshold: 0.65};\n    for (const c of Array.from(l.getElementsByClassName('container'))) {\n      new Sortable(c, lOpts);\n    }\n    for (const rem of Array.from(l.getElementsByClassName(\"remove\"))) {\n      (rem as HTMLElement).onclick = function() { remove(dd, rem.parentElement?.parentElement!); };\n    }\n\n    const r = dd.querySelector(\".r\");\n    if (r) {\n      const rOpts = {group: {name: 'nested', pull: \"clone\", put: false}, handle: '.handle', animation: 150, fallbackOnBody: true, swapThreshold: 0.65, sort: false};\n      for (const c of Array.from(r.getElementsByClassName('container'))) {\n        new Sortable(c, rOpts);\n      }\n    }\n    update(dd);\n  }\n}\n\nfunction remove(dd: Element, rem: Element) {\n  rem.remove();\n  update(dd);\n}\n\nfunction update(dd: Element) {\n  const sEl = document.querySelector(\".drag-state\") as HTMLInputElement;\n  if (!sEl) {\n    return;\n  }\n  const origEl = document.querySelector(\".drag-state-original\") as HTMLInputElement;\n  const trackedEl = dd.querySelector(\".tracked\") as HTMLElement;\n  const [i, count] = readContainer(trackedEl);\n  const js = JSON.stringify(i);\n  if (origEl) {\n    if (origEl.value.length === 0) {\n      origEl.value = js;\n    }\n    const aEl = document.querySelector(\".drag-actions\") as HTMLElement;\n    if (aEl) {\n      if (origEl.value === js) {\n        aEl.classList.add('no-changes');\n      } else {\n        aEl.classList.remove('no-changes');\n      }\n    }\n    const sEl = document.querySelector(\".drag-tracked-size\") as HTMLElement;\n    if (sEl) {\n      sEl.innerText = count.toString(10);\n    }\n  }\n\n  sEl.value = js;\n}\n\ninterface Item {\n  k: string\n  p: string\n  c?: Item[]\n}\n\nfunction readContainer(c: Element): [Item[], number] {\n  let count = 0;\n  const ret: Item[] = [];\n  for (const i of Array.from(c.children)) {\n    if (i.classList.contains(\"item\")) {\n      const [item, c] = readItem(i as HTMLElement);\n      if (item) {\n        ret.push(item);\n      }\n      count += c;\n    }\n  }\n  return [ret, count];\n}\n\nfunction readItem(i: HTMLElement): [Item | undefined, number] {\n  let count = 1;\n  let ret: Item = {\n    k: i.dataset.key as string,\n    p: i.dataset.originalPath as string\n  };\n  for (const x of Array.from(i.children)) {\n    if (x.classList.contains(\"container\")) {\n      const [kids, c] = readContainer(x);\n      if (kids.length > 0) {\n        ret.c = kids;\n      }\n      count += c;\n    }\n  }\n  return [ret, count];\n}\n", "export function linkInit() {\n  for (const l of Array.from(document.getElementsByClassName(\"link-confirm\"))) {\n    const el = (l as HTMLAnchorElement);\n    el.onclick = function() {\n      let msg = el.dataset.message as string;\n      if (msg && msg.length === 0) {\n        msg = \"Are you sure?\";\n      }\n      return confirm(msg);\n    }\n  }\n}\n", "import \"./client.css\"\nimport {appName} from \"./util\";\nimport {menuInit} from \"./menu\";\nimport {flashInit} from \"./flash\";\nimport {editorInit} from \"./editor\";\nimport {sortableEdit, sortableInit} from \"./sortable\";\nimport {linkInit} from \"./link\";\n\nexport function init(): void {\n  (window as any).admini = {\n    \"sortableEdit\": sortableEdit\n  };\n  menuInit();\n  flashInit();\n  linkInit();\n  editorInit();\n  sortableInit();\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", init);\n"],
  "mappings": "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",
  "names": []
}
