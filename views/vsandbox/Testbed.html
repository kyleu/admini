{% import "sort" %}
{% import "github.com/kyleu/admini/app" %}
{% import "github.com/kyleu/admini/app/controller/cutil" %}
{% import "github.com/kyleu/admini/app/result" %}
{% import "github.com/kyleu/admini/app/schema" %}
{% import "github.com/kyleu/admini/app/util" %}
{% import "github.com/kyleu/admini/views/layout" %}
{% import "github.com/kyleu/admini/views/vresult" %}
{% import "github.com/kyleu/admini/queries" %}

{% code type Testbed struct { layout.Basic } %}

{% func (p *Testbed) Body(as *app.State, ps *cutil.PageState) %}
  {% code data := ps.Data.(map[string]interface{}) %}
  <div class="card">
    <h3>Testbed!</h3>
    <div><a href="#modal-x">Open modal</a></div>
  </div>
  <div id="modal-x" class="modal" style="display: none;">
    <a class="backdrop" href="#"></a>
    <div class="modal-content">
      <div class="modal-header">
        <a href="#" class="modal-close">&times;</a>
        <h2>Modal</h2>
      </div>
      <div class="modal-body">
        Here's a modal body!
      </div>
    </div>
  </div>

  <div class="card">
    <h3>Icons!</h3>
    <div style="display: flex;">
      {%- code
        keys := make([]string, 0, len(util.SVGLibrary))
        for k, _ := range util.SVGLibrary {
          keys = append(keys, k)
        }
        sort.Strings(keys)
      -%}
      {%- for _, k := range keys -%}
      <div style="text-align: center; margin: 6px 12px 6px 0; padding: 6px; border: var(--border)">
        <div style="width: 64px; height: 64px;">{%s= util.SVGLibrary[k] %}</div>
        {%s k %}
      </div>
      {%- endfor -%}
    </div>
  </div>

  <div class="card">
    <h3>Tabs</h3>
    <div class="tabs">
      {%- for _, o := range schema.AllOrigins -%}
      <input name="type" type="radio" id="sandbox-{%s o.Key %}" class="input"/>
      <label for="sandbox-{%s o.Key %}" class="label">{%s o.Title %}</label>
      <div class="panel"><p>{%s o.Description %}</p></div>
      {%- endfor -%}
    </div>
  </div>

  <div class="card">
    <h3>Tables</h3>
    <pre>{%s queries.ListTables("") %}</pre>
    {%= vresult.View("", "", data["tables"].(*result.Result), nil, 3, nil, as, ps) %}
  </div>
  <div class="card">
    <h3>Columns</h3>
    <pre>{%s queries.ListColumns("") %}</pre>
    {%= vresult.View("", "", data["columns"].(*result.Result), nil, 3, nil, as, ps) %}
  </div>
  <div class="card">
    <h3>Indexes</h3>
    <pre>{%s queries.ListIndexes("") %}</pre>
    {%= vresult.View("", "", data["indexes"].(*result.Result), nil, 3, nil, as, ps) %}
  </div>
  <div class="card">
    <h3>Foreign Keys</h3>
    <pre>{%s queries.ListForeignKeys("") %}</pre>
    {%= vresult.View("", "", data["fks"].(*result.Result), nil, 3, nil, as, ps) %}
  </div>
{% endfunc %}
