{% import "github.com/kyleu/admini/app" %}
{% import "github.com/kyleu/admini/app/controller/cutil" %}
{% import "github.com/kyleu/admini/app/schema" %}
{% import "github.com/kyleu/admini/views/layout" %}

{% code type New struct {
  layout.Basic
  Origin schema.Origin
} %}

{% func (p *New) Body(as *app.State, ps *cutil.PageState) %}
  <div class="card">
    <h3>New Source</h3>
    <div class="spacer"></div>
    <form class="editor" action="{%s as.Route(`source.insert`) %}" method="post" enctype="application/x-www-form-urlencoded">
      <table>
        <tbody>
          <tr>
            <th class="shrink"><label for="input-key">Key</label></th>
            <td><input name="key" id="input-key" value="" /></td>
          </tr>
          <tr>
            <th class="shrink"><label for="input-title">Title</label></th>
            <td><input name="title" id="input-title" value="" /></td>
          </tr>
          <tr>
            <th class="shrink"><label for="input-description">Description</label></th>
            <td><input name="description" id="input-description" value="" /></td>
          </tr>
          <tr>
            <th class="shrink"><label>Type</label></th>
            <td>
              {%- for _, o := range schema.AllOrigins -%}
              {%- if o == p.Origin  -%}
              <label><input name="type" type="radio" class="input" value="{%s o.Key %}" checked="checked" /> {%s o.Title %}</label>
              {%- else -%}
              <label><input name="type" type="radio" class="input" value="{%s o.Key %}" /> {%s o.Title %}</label>
              {%- endif -%}
              {%- endfor -%}
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <button type="submit">Save Changes</button>
              <a href="{%s as.Route(`source.list`) %}"><button>Cancel</button></a>
            </td>
          </tr>
        </tbody>
      </table>
    </form>
  </div>
{% endfunc %}
