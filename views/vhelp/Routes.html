{% import "github.com/kyleu/admini/app" %}
{% import "github.com/kyleu/admini/app/controller/cutil" %}
{% import "github.com/kyleu/admini/views/components/fieldview" %}
{% import "github.com/kyleu/admini/views/layout" %}
{% import "strings" %}

{% code type Routes struct {
  layout.Basic
  Routes []*cutil.RouteDescription
} %}

{% func (p *Routes) Body(as *app.State, ps *cutil.PageState) %}
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Methods</th>
        <th>Path</th>
      </tr>
    </thead>
    <tbody>
      {% for _, r := range p.Routes %}
        {% if r.Path == "" %}
        {% elseif len(r.Methods) == 0 %}<tr>
          <th scope="row" colspan="3"><div class="mt">{%s strings.TrimPrefix(r.Path, "/") %}</div></th>
        </tr>{% else %}<tr>
          <td>{%= fieldview.String(r.Name) %}</td>
          <td>{%= fieldview.String(r.Methods) %}</td>
          <td>{% if strings.Contains(r.Methods, "GET") && !strings.Contains(r.Path, "{") %}<a href="{%s r.Path %}">{%= fieldview.String(r.Path) %}</a>{% else %}{%= fieldview.String(r.Path) %}{% endif %}</td>
        </tr>{% endif %}{% endfor %}
    </tbody>
  </table>
{% endfunc %}
