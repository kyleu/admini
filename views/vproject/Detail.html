{% import "github.com/kyleu/admini/app" %}
{% import "github.com/kyleu/admini/app/controller/cutil" %}
{% import "github.com/kyleu/admini/app/project" %}
{% import "github.com/kyleu/admini/views/components/fieldview" %}
{% import "github.com/kyleu/admini/views/layout" %}

{% code type Detail struct {
  layout.Basic
  Project *project.Project
} %}

{% func (p *Detail) Body(as *app.State, ps *cutil.PageState) %}
  <div class="card">
    <h3>{%s p.Project.Title %}</h3>
    <p>
      <a href="{%s as.Route(`workspace`, `key`, p.Project.Key) %}"><button type="button">Workspace</button></a>
      <a href="#modal-project"><button type="button">Project</button></a>
    </p>
  </div>

  <div class="card">
    <h3>Actions</h3>
    <ul id="action-list" class="grid">
      {%- for _, act := range p.Project.Actions -%}
      {%= ActionList(act, as, ps, 3) %}
      {%- endfor -%}
    </ul>
  </div>

  <div id="modal-project" class="modal" style="display: none;">
    <a class="backdrop" href="#"></a>
    <div class="modal-content">
      <div class="modal-header">
        <a href="#" class="modal-close">&times;</a>
        <h2>Project JSON</h2>
      </div>
      <div class="modal-body">
        {%= fieldview.JSON(p.Project) %}
      </div>
    </div>
  </div>

  <script type="text/javascript" src="/assets/dragdrop.js"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
      lmdd.set(document.getElementById('action-list'), {
        containerClass: 'grid',
        draggableItemClass: 'item'
      });
    });
  </script>
{% endfunc %}
