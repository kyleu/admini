#!/bin/bash
# Code generated by Project Forge, see https://projectforge.dev for details.

set -eo pipefail
dir="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd $dir/../..

TGT=$1
[ "$TGT" ] || (echo "must provide one argument, like \"0.0.1\"" && exit)

if [ "$XSKIP_NOTARIZE" != "true" ]
then
  sed -i '' "s/[v]*[01]\.[0-9]*[0-9]\.[0-9]*[0-9][-SNAPSHOT]*/$TGT/g" ./tools/notarize/gon.amd64.hcl
  time gon ./tools/notarize/gon.amd64.hcl
fi
